{"version":3,"file":"static/js/760.426dedaf.chunk.js","mappings":"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","sources":["componant/Login.jsx"],"sourcesContent":["import React, { useRef, useState } from \"react\";\r\nimport \"../componantStyle/Login.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Joi from \"joi\";\r\nimport {useUser} from '../context/Context'\r\n// import { jwtDecode } from \"jwt-decode\";\r\nexport default function Login() {\r\n  const navigate = useNavigate();\r\n  const [login, setLogin] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [errorLogin, setErrorLogin] = useState(null);\r\n  const [ errorListLogin, setListErrorLogin ] = useState( null );\r\n  const df = useRef();\r\n  const {direction} = useUser()\r\n  function handleChange(e) {\r\n    setLogin((pre) => ({\r\n      ...pre,\r\n      [e.target.name]: e.target.value,\r\n    }));\r\n  }\r\n  function validateLogin() {\r\n    let Schema = Joi.object({\r\n      email_or_phone: Joi.string().required(),\r\n\r\n      password: Joi.string().required(),\r\n    });\r\n    return Schema.validate(login, { abortEarly: true });\r\n  }\r\n  async function Login(e) {\r\n    e.preventDefault();\r\n    let responseValidateLogin = validateLogin();\r\n    if (responseValidateLogin.error) {\r\n      setListErrorLogin(responseValidateLogin.error.details);\r\n    } else {\r\n      try {\r\n        setLoading(true);\r\n        const response = await fetch(\r\n          \"https://kog.pythonanywhere.com/api/v1/accounts/login/\",\r\n          {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify(login),\r\n          }\r\n        );\r\n        const result = await response.json();\r\n        setLoading( false );\r\n        setErrorLogin(null)\r\n        if (result.tokens) {\r\n          setErrorLogin(null);\r\n          localStorage.setItem(\"token_access\", result.tokens.access);\r\n          localStorage.setItem( \"token_refresh\", result.tokens.refresh );\r\n          localStorage.setItem( \"roleBycrypt\", result.role );\r\n          if (result.role === \"admin\") {\r\n            navigate(\"/dashboard\");\r\n          } else {\r\n            navigate(\"/\");\r\n          }\r\n        } else {\r\n          setErrorLogin(result);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    }\r\n  }\r\n  return (\r\n    <form className=\"formLogin\" onSubmit={Login} ref={df}>\r\n      {errorLogin && (\r\n        <p className=\"alert alert-secondary\">{errorLogin.non_field_errors}</p>\r\n      )}\r\n      {errorListLogin &&\r\n        errorListLogin.map((error, index) => (\r\n          <p key={index} className=\"alert alert-secondary\">\r\n            {error.message}\r\n          </p>\r\n        ))}\r\n      <div className=\"inp\">\r\n        <label htmlFor=\"mobile\">\r\n          {direction === \"EN\" ? \"email_or_phone\" : \"  الايميل او رقم الهاتف\"}\r\n        </label>\r\n        <br />\r\n        <input\r\n          type=\"string\"\r\n          name=\"email_or_phone\"\r\n          id=\"mobile\"\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n      <div className=\"inp\">\r\n        <label htmlFor=\"password\">\r\n          {direction === \"EN\" ? \"password\" : \"كلمة المرور\"}\r\n        </label>\r\n        <br />\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          id=\"password\"\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"inp\">\r\n        <button className=\"btn btn-secondary\">\r\n          {loading ? (\r\n            <div className=\"spinner-border text-secondary\" role=\"status\">\r\n              <span className=\"sr-only\"></span>\r\n            </div>\r\n          ) : (\r\n            <>{direction === \"EN\" ? \" Login\" : \"تسجيل\"}</>\r\n          )}\r\n        </button>\r\n        <button\r\n          className=\"btn btn-secondary\"\r\n          onClick={() => navigate(\"/register\")}\r\n        >\r\n          {direction === \"EN\" ? \"sign up \" : \"حساب جديد\"}\r\n        </button>\r\n        <button\r\n          className=\"btn btn-secondary\"\r\n          onClick={() => navigate(\"/changepassword\")}\r\n        >\r\n          {direction === \"EN\" ? \"change password \" : \" تغيير كلمة المرور\"}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":["Login","navigate","useNavigate","login","setLogin","useState","loading","setLoading","errorLogin","setErrorLogin","errorListLogin","setListErrorLogin","df","useRef","direction","useUser","handleChange","e","pre","target","name","value","_jsxs","className","onSubmit","async","preventDefault","responseValidateLogin","Joi","email_or_phone","required","password","validate","abortEarly","error","details","response","fetch","method","headers","body","JSON","stringify","result","json","tokens","localStorage","setItem","access","refresh","role","console","ref","children","_jsx","non_field_errors","map","index","message","htmlFor","type","id","onChange","_Fragment","onClick"],"sourceRoot":""}